{"version":3,"file":"incourse_courseindex.min.js","sources":["../src/incourse_courseindex.js"],"sourcesContent":["/* eslint-disable */\nimport * as Storage from 'core/sessionstorage';\nimport log from 'core/log';\nimport ajax from 'core/ajax';\n\nasync function loadCourse(stateKey, courseId, section) {\n    if (this.courseId) {\n        throw new Error(`Cannot load ${courseId}, course already loaded with id ${this.courseId}`);\n    }\n\n    this.courseId = courseId;\n\n    this.section = section;\n\n    const storeStateKey = Storage.get(`course/${courseId}/staticState`);\n\n    let stateData;\n\n    try {\n        // Check if the backend state key is the same we have in our session storage.\n        if (stateKey == storeStateKey) {\n            stateData = JSON.parse(Storage.get(`course/${courseId}/staticState`));\n        }\n        if (!stateData) {\n            stateData = await getServerCourseState();\n        }\n\n    } catch (error) {\n        log.error(\"EXCEPTION RAISED WHILE INIT COURSE EDITOR\");\n        log.error(error);\n        return;\n    }\n\n    console.log(stateData);\n}\n\nasync function getServerCourseState() {\n    const courseState = await ajax.call([{\n        methodname: 'core_courseformat_get_state',\n        args: {\n            courseid: this.courseId,\n        }\n    }])[0];\n\n    const stateData = JSON.parse(courseState);\n\n    return {\n        course: {},\n        section: [],\n        cm: [],\n        ...stateData,\n    };\n}\n\nexport function init(stateKey, courseId, section) {\n    loadCourse(stateKey, courseId, section);\n}\n"],"names":["stateKey","courseId","section","this","Error","storeStateKey","Storage","get","stateData","JSON","parse","courseState","ajax","call","methodname","args","courseid","course","cm","getServerCourseState","error","console","log","loadCourse"],"mappings":"+jBAsDqBA,SAAUC,SAAUC,yBAjDfF,SAAUC,SAAUC,YACtCC,KAAKF,eACC,IAAIG,4BAAqBH,oDAA2CE,KAAKF,gBAG9EA,SAAWA,cAEXC,QAAUA,cAETG,cAAgBC,QAAQC,qBAAcN,8BAExCO,cAIIR,UAAYK,gBACZG,UAAYC,KAAKC,MAAMJ,QAAQC,qBAAcN,4BAE5CO,YACDA,uCAaFG,kBAAoBC,cAAKC,KAAK,CAAC,CACjCC,WAAY,8BACZC,KAAM,CACFC,SAAUb,KAAKF,aAEnB,SAIG,CACHgB,OAAQ,GACRf,QAAS,GACTgB,GAAI,MALUT,KAAKC,MAAMC,cApBHQ,IAGxB,MAAOC,2BACDA,MAAM,+DACNA,MAAMA,OAIdC,QAAQC,IAAId,WAsBZe,CAAWvB,SAAUC,SAAUC"}